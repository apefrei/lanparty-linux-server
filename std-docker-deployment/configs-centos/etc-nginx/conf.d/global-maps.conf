###
### This file contains global maps useable for all sites
###

### FCGI-Cacheing: Do not clear cookie header if X-No-Cache header is set
###                Use in vhost configuration to prevent removal of cookies
###                if X-No-Cache header is set:
###
###                if ($skip_cache = 0) {
###                    more_clear_headers $clear_cookie_headers;
###                }
map $sent_http_x_no_cache $clear_cookie_headers {
    default "Set-Cookie*";
    "1"     "";
}
# If we receive X-Forwarded-Proto, pass it through; otherwise, pass along the
# scheme used to connect to this server
map $http_x_forwarded_proto $proxy_x_forwarded_proto {
  default $http_x_forwarded_proto;
  ''      $scheme;
}
# If we receive X-Forwarded-Port, pass it through; otherwise, pass along the
# server port the client connected to
map $http_x_forwarded_port $proxy_x_forwarded_port {
  default $http_x_forwarded_port;
  ''      $server_port;
}
# If we receive Upgrade, set Connection to "upgrade"; otherwise, delete any
# Connection header that may have been passed to this server
map $http_upgrade $proxy_connection {
  default upgrade;
  '' close;
}


